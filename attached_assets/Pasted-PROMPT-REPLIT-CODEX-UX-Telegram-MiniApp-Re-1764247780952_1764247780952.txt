PROMPT ДЛЯ REPLIT / CODEX

Нужно доработать UX формы создания объявления в моём Telegram MiniApp (React + TypeScript). Я опишу полный сценарий — реализуй всё ниже.

0. Общий контекст

Технологии:

Frontend: React / TypeScript

Telegram WebApp / MiniApp (мобильный UI, вертикальный скролл)

Сценарий:
Пользователь заходит в приложение → вкладка «Мои объявления» → нажимает кнопку «Создать» и проходит мастер создания объявления по шагам.

1. Экран загрузки при переходе «Создать объявление»

Текущее поведение: После нажатия кнопки «Создать» всё просто подгружается без нормального визуального состояния.

Нужно сделать:

При нажатии «Создать»:

Показать красивый экран загрузки:

логотип проекта Ketmar (центральный элемент),

можно небольшой анимированный индикатор (spinner, progress bar или пульсация логотипа).

Этот экран виден, пока:

подгружаются данные для формы (гео, категории и т.д.),

подготовлен первый шаг мастера.

Как только первый шаг готов:

скрыть экран загрузки,

показать первый шаг мастера.

2. Определение города / гео

Текущее поведение: Есть выбор города из списка.

Нужно:

Убрать выбор города из списка полностью.

Сделать так, чтобы локация определялась автоматически:

через уже реализованную геолокацию (координаты, район и т.п.).

На UI можно оставить просто текст:

«Местоположение определено автоматически» + название города/района (read-only).

Пользователь не выбирает город вручную в этом сценарии.

3. Шаг «Фотографии»

Текущее поведение: Можно добавить несколько фото, но нельзя управлять их порядком и явной «главной» фотографией.

Нужно:

Разрешить добавлять до 4 фотографий (если уже так — оставить, но явно учесть).

Реализовать перемещение фотографий между слотами:

drag & drop или тап по миниатюре с выбором позиции.

Главное: пользователь может сменить порядок фотографий.

Первая фотография в списке считается главной:

Отмечать её визуально (рамка, бейдж «Главное фото»).

При изменении порядка автоматически меняется главная.

4. Шаг «Название» (что продаете)

Поле: «Что продаёте?» — пример: пользователь пишет «перец».

Нужно изменить поведение клавиатуры:

Когда пользователь вводит название и нажимает Enter:

event.preventDefault() — не добавлять перенос строки.

Снять фокус с инпута (input.blur()).

В результате клавиатура должна скрыться.

После этого можно:

показать выпадающее окно/группу «Применить» (как сейчас),

по нажатию «Применить» двигаем пользователя дальше по мастеру.

Важно:
Клавиатура должна появляться снова только если пользователь:

заново тапает в поле названия,

или возвращается на этот шаг и мы явно ставим фокус.

5. Шаг «Цена»

Поле для ввода цены (например, 16.00).

Нужно:

По возможности использовать цифровую клавиатуру:

на мобильных: только цифры + точка,

например inputMode="decimal" / type="number" (учесть Telegram WebApp и мобильные браузеры).

При вводе цены:

когда пользователь нажимает Enter:

убрать фокус с поля,

скрыть клавиатуру.

Цена — числовое поле (16, 16.50 и т.п.), валидация:

не позволять вводить лишние буквы,

при ошибке — аккуратное сообщение.

6. Шаг «Описание» (по желанию, с AI)

Есть два варианта:

«Использовать» — взять текст, который сгенерировал AI.

«Исправить» — пользователь пишет/редактирует вручную.

Нужно:

Если пользователь нажимает «Использовать»:

Вставить AI-текст в поле описания.

НЕ фокусировать поле.

Не показывать клавиатуру.

Пользователь сразу может нажать «Далее» без лишних всплывающих клавиатур.

Если пользователь нажимает «Исправить»:

Поставить фокус в поле описания.

Показать клавиатуру.

При нажатии Enter в конце:

снять фокус (blur()),

скрыть клавиатуру,

можно подсветить кнопку «Далее» как следующий шаг.

Логика:

«Использовать AI» = без клавиатуры.

«Исправить» = открываем клавиатуру, пока пользователь редактирует.

7. Шаг «Контакты / Instagram / Время публикации»

На этом шаге есть:

поле Instagram (по желанию),

опции времени публикации (сейчас / запланировать).

Нужно выделить Instagram:

При первом входе на этот шаг (после описания):

если поле Instagram пустое:

мягко подсветить его:

например, сделать обводку слегка светящейся,

или два раза «моргнуть» (анимация opacity/outline).

при необходимости проскроллить так, чтобы это поле было видно.

Подсветка должна:

быть аккуратной, не раздражающей,

исчезнуть после:

нескольких секунд, или

первого фокуса/клика по полю.

Текст-подсказка под полем можно сделать типа:

«По желанию: добавьте Instagram для доверия и дополнительного контакта».

8. Экран проверки перед публикацией

После всех шагов пользователь попадает на экран предпросмотра объявления перед нажатием «Публиковать».

Нужно настроить фиксированные элементы:

Верхняя панель (header):

Логотип / надпись Ketmar + иконка-звонок (телефон).

Этот хедер должен быть зафиксирован (sticky/fixed) сверху:

при скроллинге объявления хедер не двигается.

Полоска прогресса/заголовка:

Полоса, где написано «Подача объявлений» (с шагами/циклом).

Тоже фиксирована под хедером.

При скролле она остаётся на месте.

Кнопка «Публиковать»:

Должна быть закреплена внизу экрана, всегда видна.

Пользователь может скроллить только содержимое объявления между полоской прогресса и кнопкой «Публиковать».

Верх (Ketmar + звоночек) и полоска прогресса не двигаются, низ с кнопкой тоже фиксирован.

Область скролла:

Только блок с предпросмотром объявления (фото, текст, цена, контакты и т.д.) скроллится внутри отведённой области.

9. Кнопка «Публиковать» и редирект в «Мои объявления»

Текущая проблема:
Пользователь может нажать «Публиковать» несколько раз подряд, пока идёт запрос, и создать дубликаты.

Нужно:

При первом клике по «Публиковать»:

сразу:

отключить кнопку (disabled),

сменить текст на, например, «Публикуем…»,

можно показать маленький спиннер в кнопке.

Отправить запрос на сервер один раз.

При успешной публикации:

Показать короткое уведомление (toast / alert):

«Объявление опубликовано».

Автоматически переключить вкладку на «Мои объявления».

Пользователь должен видеть свой список объявлений,

новое объявление — в списке (по возможности, сверху).

При ошибке:

Показать сообщение об ошибке.

Снова включить кнопку «Публиковать» (убрать disabled и спиннер), чтобы можно было повторить попытку.

Важно: не создавать дубликатов при ошибках/повторных кликах.

10. Технические детали реализации

Вся логика мастера должна быть централизована:

единое состояние по шагам (React state / context / reducer).

Для обработки клавиатуры:

использовать onKeyDown или onKeyPress,

проверка event.key === 'Enter',

event.preventDefault() и event.currentTarget.blur() для скрытия клавиатуры.

Фиксированные элементы:

использовать position: sticky или position: fixed в зависимости от текущей верстки,

адаптировать под мобильный внутри Telegram WebApp.

Реализуй все описанные изменения, сохрани текущий визуальный стиль проекта, но добавь описанное поведение для загрузки, гео, фотографий, клавиатуры, подсветки Instagram, фиксированных элементов на экране предпросмотра и редиректа в «Мои объявления» после успешной публикации.