PROMPT –î–õ–Ø REPLIT / CODEX  
–ó–∞–¥–∞—á–∞: –¥–æ–±–∞–≤–∏—Ç—å –≤ KETMAR Market —É–º–Ω—ã–π AI-—Å–ª–æ–π:

1) –ê–≤—Ç–æ–æ–ø–∏—Å–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π (title/description –ø–æ–¥—Å–∫–∞–∑–∫–∏),
2) ML-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–ø–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –ª–µ–Ω—Ç–∞),
3) –ê–Ω—Ç–∏—Å–ø–∞–º / –∞–Ω—Ç–∏–º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ / –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ—Ä–∞—Ü–∏—è.

–ù—É–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ–≤–µ—Ä—Ö —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:
- backend (Node.js + TypeScript + Mongo + Geo),
- miniapp (React + TS),
- admin (React + TS),
- bot (Telegraf),
- —Ñ–µ—Ä–º–µ—Ä—Å–∫–∏–π –º–æ–¥—É–ª—å, –≥–µ–æ–ª–µ–Ω—Ç–∞, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (—É–∂–µ –µ—Å—Ç—å).

====================================================================
0. –û–ë–©–ê–Ø –ò–î–ï–Ø AI-–°–õ–û–Ø
====================================================================

–°–¥–µ–ª–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å (–ø–∞–ø–∫—É / —Å–µ—Ä–≤–∏—Å) —É—Ä–æ–≤–Ω—è:

- `/backend/src/ai` –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å `/ai-service`,
–∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞:

- –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–µ–∫—Å—Ç–æ–≤ (–∑–∞–≥–æ–ª–æ–≤–æ–∫/–æ–ø–∏—Å–∞–Ω–∏–µ),
- –ø–æ–¥—Å–∫–∞–∑–∫—É —Ü–µ–Ω—ã (–Ω–∞ —Ñ–æ–Ω–µ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π),
- ML-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–ø–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã / –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –ª–µ–Ω—Ç–∞),
- –∞–Ω—Ç–∏—Å–ø–∞–º –∏ —Ä–∏—Å–∫-—Ñ–∞–∫—Ç–æ—Ä—ã (–º–∞—Ç, –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ, –∑–∞–ø—Ä–µ—â—ë–Ω–∫–∞),
- –ø–æ–¥—Å–∫–∞–∑–∫–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—É (admin-–ø–∞–Ω–µ–ª—å).

–í—Å—è –ª–æ–≥–∏–∫–∞ AI –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞ –∫–∞–∫:
- **–æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–ª–æ–π**, —á—Ç–æ–±—ã –µ–≥–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –∑–∞–º–µ–Ω–∏—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–Ω–µ—à–Ω–∏–º API),
- —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏/–∫–ª–∏–µ–Ω—Ç–∞–º–∏, –∞ –Ω–µ –ø—Ä—è–º—ã–º –≤—ã–∑–æ–≤–æ–º –≤–µ–∑–¥–µ.

====================================================================
1. –ê–í–¢–û–û–ü–ò–°–ê–ù–ò–Ø –û–ë–™–Ø–í–õ–ï–ù–ò–ô
====================================================================

–¶–µ–ª—å: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –æ–±–ª–µ–≥—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è,  
–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –±–∞–±—É—à–µ–∫, —Ñ–µ—Ä–º–µ—Ä–æ–≤ –∏ –ª—é–¥–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —É–º–µ—é—Ç –∫—Ä–∞—Å–∏–≤–æ –ø–∏—Å–∞—Ç—å.

‚öôÔ∏è –¢—Ä–µ–±—É–µ—Ç—Å—è:

1) –ù–∞ –±—ç–∫–µ ‚Äî —Å–µ—Ä–≤–∏—Å `AiTextService`:

–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–ø—Å–µ–≤–¥–æ–∫–æ–¥):

```ts
interface AiTextService {
  suggestTitle(input: {
    categoryId?: string;
    subcategoryId?: string;
    rawText?: string;        // —á–µ—Ä–Ω–æ–≤–∏–∫ —Ç–µ–∫—Å—Ç–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    attributes?: Record<string, any>; // —Ü–µ–Ω–∞, –±—Ä–µ–Ω–¥, –º–æ–¥–µ–ª—å, –≥–æ–¥ –∏ —Ç.–¥.
  }): Promise<string[]>; // –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞

  suggestDescription(input: {
    categoryId?: string;
    subcategoryId?: string;
    title?: string;
    bulletPoints?: string[]; // –∫–ª—é—á–µ–≤—ã–µ —Ñ—Ä–∞–∑—ã/–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
    attributes?: Record<string, any>;
  }): Promise<string>; // –æ–¥–∏–Ω –ø—Ä–æ–¥—É–º–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç

  suggestTags(input: {
    title: string;
    description: string;
    categoryId?: string;
  }): Promise<string[]>; // —Ç–µ–≥–∏ / –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
}
–í–Ω—É—Ç—Ä–∏ —Å–µ–π—á–∞—Å –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∑–∞–≥–ª—É—à–∫—É:

–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ —à–∞–±–ª–æ–Ω—ã + –ø—Ä–∞–≤–∏–ª–∞ (–±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ LLM),

–Ω–æ –≤—Å—ë —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –º–æ–∂–Ω–æ –±—ã–ª–æ –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –≤–Ω–µ—à–Ω–∏–π AI API.

–ù–∞ —Ñ—Ä–æ–Ω—Ç–µ ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Ñ–æ—Ä–º—É –ø–æ–¥–∞—á–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è:

–ù–∞ —à–∞–≥–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è:

–æ–±—ã—á–Ω—ã–µ –ø–æ–ª—è:

"–ó–∞–≥–æ–ª–æ–≤–æ–∫"

"–û–ø–∏—Å–∞–Ω–∏–µ"

—Ä—è–¥–æ–º:

–∫–Ω–æ–ø–∫–∞ ¬´‚úç –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫¬ª,

–∫–Ω–æ–ø–∫–∞ ¬´ü§ñ –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ¬ª.

UX:

–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤—ë–ª —á–µ—Ä–Ω–æ–≤–∏–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–ø—Ä–æ–¥–∞–º –∞–π—Ñ–æ–Ω 13, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–æ—Ä–º") ‚Äî
–ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ ¬´–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫¬ª:

–∑–∞–ø—Ä–æ—Å –∫ /api/ai/suggest-title,

–ø–æ–∫–∞–∑—ã–≤–∞–µ–º 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞:

"iPhone 13, –æ—Ç–ª–∏—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ"

"iPhone 13, –ø–æ—á—Ç–∏ –Ω–æ–≤—ã–π, –±–µ–∑ —Å–∫–æ–ª–æ–≤"

"iPhone 13, –ø–æ–ª–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Ç, –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ"

–º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –ª—é–±–æ–π, –∫–ª–∏–∫–Ω—É–≤.

–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º:

–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–ø–∏—Å–∞–ª 1‚Äì2 —Ñ—Ä–∞–∑—ã,

—Å–µ—Ä–≤–∏—Å –¥–æ–ø–æ–ª–Ω—è–µ—Ç:

—Å—Ç—Ä—É–∫—Ç—É—Ä–∞: —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è, –ø—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏, —É—Å–ª–æ–≤–∏—è –≤—Å—Ç—Ä–µ—á–∏.

–ë—ç–∫–µ–Ω–¥-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:

http
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
POST /api/ai/suggest-title
POST /api/ai/suggest-description
POST /api/ai/suggest-tags
üí° –í–∞–∂–Ω–æ:
–°–¥–µ–ª–∞—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ DTO –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é,
–∏ –≤ –∫–æ–¥–µ –ø–æ–º–µ—Ç–∏—Ç—å, –≥–¥–µ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π LLM (–Ω–∞–ø—Ä–∏–º–µ—Ä, OpenAI).

====================================================================
2. –£–ú–ù–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò (ML-–†–ï–ö–û–ú–ï–ù–î–ê–¢–û–†)
–¶–µ–ª–∏:

–ü–æ—Ö–æ–∂–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ —Ç–æ–≤–∞—Ä–∞.

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ "–≤–∞–º –º–æ–∂–µ—Ç –ø–æ–Ω—Ä–∞–≤–∏—Ç—å—Å—è" –≤ –ª–µ–Ω—Ç–µ.

–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –ª–µ–Ω—Ç–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

‚öôÔ∏è –¢—Ä–µ–±—É–µ—Ç—Å—è:

2.1. –°–µ—Ä–≤–∏—Å RecommendationService:

ts
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
interface RecommendationService {
  getSimilarAds(input: {
    adId: string;
    limit?: number;
  }): Promise<Ad[]>;

  getPersonalFeed(input: {
    userId?: string;
    telegramId?: number;
    lat?: number;
    lng?: number;
    radiusKm?: number;
    limit?: number;
  }): Promise<Ad[]>;

  getTrendingNearby(input: {
    lat: number;
    lng: number;
    radiusKm: number;
    limit?: number;
  }): Promise<Ad[]>;
}
–ë–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–±–µ–∑ —Ç—è–∂—ë–ª–æ–≥–æ ML):

getSimilarAds:

–ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏/–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏,

–ø–æ —Ü–µ–Ω–µ +- –¥–∏–∞–ø–∞–∑–æ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, +- 20%),

–ø–æ –≥–µ–æ (—Ç–æ—Ç –∂–µ –≥–æ—Ä–æ–¥/—Ä–∞–π–æ–Ω),

–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏—é:

—Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ (title + description ‚Üí tf-idf –∏–ª–∏ cosine similarity),

—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –±—Ä–µ–Ω–¥–∞/–º–æ–¥–µ–ª–∏ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤/–∞–≤—Ç–æ.

getPersonalFeed:

–∏—Å—Ç–æ—Ä–∏—è:

–ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è,

–¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ,

–∫–ª–∏–∫–∏ –ø–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º,

–ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã.

–±–∞–∑–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º:

—á–∞—â–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª,

—Å–º–µ—à–∏–≤–∞—Ç—å:

–Ω–æ–≤—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è,

"–ø–æ—Ö–æ–∂–∏–µ –Ω–∞ —Ç–µ, —á—Ç–æ —Å–º–æ—Ç—Ä–µ–ª",

"–ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ä—è–¥–æ–º".

getTrendingNearby:

–ø–æ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ:

—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ:

–∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ X —á–∞—Å–æ–≤,

–∫–æ–ª–∏—á–µ—Å—Ç–≤—É –¥–æ–±–∞–≤–ª–µ–Ω–∏–π –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ,

–∫–ª–∏–∫–∞–º –ø–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º,

–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –±–ª–æ–∫:

¬´–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ —Ä—è–¥–æ–º —Å –≤–∞–º–∏¬ª.

2.2. Endpoint‚Äô—ã:

http
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
GET /api/ads/:id/similar
GET /api/recommendations/feed
GET /api/recommendations/trending-nearby
2.3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:

–ù–∞ –∫–∞—Ä—Ç–æ—á–∫–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è:

–±–ª–æ–∫: ¬´–ü–æ—Ö–æ–∂–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Ä—è–¥–æ–º¬ª

–¥–∞–Ω–Ω—ã–µ —Å /api/ads/:id/similar.

–ù–∞ –ª–µ–Ω—Ç–µ:

–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –ª–µ–Ω—Ç—É /api/recommendations/feed.

–µ—Å–ª–∏ –Ω–µ—Ç ‚Üí –ø—Ä–æ—Å—Ç–æ /api/ads/nearby + "—Ç—Ä–µ–Ω–¥—ã —Ä—è–¥–æ–º".

====================================================================
3. –ê–ù–¢–ò–°–ü–ê–ú / –ê–ù–¢–ò–ú–û–®–ï–ù–ù–ò–ß–ï–°–¢–í–û / –ú–û–î–ï–†–ê–¶–ò–Ø
–¶–µ–ª—å: –∑–∞—â–∏—Ç–∏—Ç—å –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å –æ—Ç:

—Å–ø–∞–º–∞,

–º–∞—Ç–æ–≤,

–∑–∞–ø—Ä–µ—â—ë–Ω–Ω–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏,

–º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏—Ö —Å—Ö–µ–º,

–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö/Telegram-–∫–æ–Ω—Ç–∞–∫—Ç–æ–≤.

‚öôÔ∏è –¢—Ä–µ–±—É–µ—Ç—Å—è:

3.1. –°–µ—Ä–≤–∏—Å ModerationService:

ts
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
interface ModerationResult {
  isSpam: boolean;
  isScam: boolean;
  hasProhibitedContent: boolean;
  hasBadWords: boolean;
  riskScore: number; // 0-100
  reasons: string[];
}

interface ModerationService {
  checkAd(input: {
    title: string;
    description: string;
    categoryId?: string;
    price?: number;
    phone?: string;
    username?: string;
    photos?: string[];
  }): Promise<ModerationResult>;
}
–ë–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

hasBadWords:

—Å–ø–∏—Å–æ–∫ —Ä—É–≥–∞—Ç–µ–ª—å—Å—Ç–≤ –Ω–∞ —Ä—É—Å—Å–∫–æ–º/–±–µ–ª–æ—Ä—É—Å—Å–∫–æ–º,

—Ä–µ–≥—É–ª—è—Ä–∫–∏ –ø–æ —Ç–∏–ø—É "xxx" / casino / 18+ –∏ –ø–æ–¥–æ–±–Ω–æ–µ.

hasProhibitedContent:

—Å–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π/—Å–ª–æ–≤:

–æ—Ä—É–∂–∏–µ,

–Ω–∞—Ä–∫–æ—Ç–∏–∫–∏,

—Ñ–∞–ª—å—à–∏–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã,

—ç–∫—Å—Ç—Ä–µ–º–∏–∑–º –∏ —Ç.–¥.

–≤—Å—ë —ç—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥–µ –∏/–∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ ModerationDictionary.

isSpam / isScam (–ø–µ—Ä–≤—ã–π —ç—Ç–∞–ø ‚Äî —ç–≤—Ä–∏—Å—Ç–∏–∫–∞):

–æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ç–µ–∫—Å—Ç –≤ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –æ—Ç –æ–¥–Ω–æ–≥–æ user/—Ç–µ–ª–µ—Ñ–æ–Ω–∞,

–æ—á–µ–Ω—å –Ω–∏–∑–∫–∏–µ —Ü–µ–Ω—ã –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (–∞–π—Ñ–æ–Ω—ã "–ø–æ 50$"),

–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—Ä–∞–∑—ã:

"100% –≥–∞—Ä–∞–Ω—Ç–∏—è", "–∑–∞—Ä–∞–±–æ—Ç–∞–π –ª–µ–≥–∫–æ", "—Å—Ç–∞–≤–∫–∏", "–∫–∞–∑–∏–Ω–æ", "–≤–∫–ª–∞–¥—ã", –∏ —Ç.–ø.

–∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏ –∏ –∫–∞–ø—Å–æ–º.

riskScore:

–Ω–∞–ø—Ä–∏–º–µ—Ä:

+30 –∑–∞ –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö —Å–ª–æ–≤,

+20 –∑–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω (—Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å "—á—ë—Ä–Ω—ã–º —Å–ø–∏—Å–∫–æ–º"),

+20 –∑–∞ flood (—Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ—Å—Ç–æ–≤ –∑–∞ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è),

+10 –∑–∞ –Ω–µ—Ç–∏–ø–∏—á–Ω—É—é —Ü–µ–Ω—É (—Å–ª–∏—à–∫–æ–º –¥—ë—à–µ–≤–æ),

–∏—Ç–æ–≥–æ ‚Üí —à–∫–∞–ª–∞ 0-100.

3.2. –ü–æ–≤–µ–¥–µ–Ω–∏–µ:

–ï—Å–ª–∏ hasProhibitedContent ‚Üí –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ —Å—Ç–∞—Ç—É—Å "blocked" –∏ –≤ –æ—á–µ—Ä–µ–¥—å –º–æ–¥–µ—Ä–∞—Ü–∏–∏.

–ï—Å–ª–∏ riskScore > 70 ‚Üí "–Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é" + —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º.

–ï—Å–ª–∏ riskScore 40-70 ‚Üí "—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞", –Ω–æ –º–æ–∂–Ω–æ —á–∞—Å—Ç–∏—á–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å –æ—Ç–º–µ—Ç–∫–æ–π.

–ï—Å–ª–∏ –≤—Å—ë –æ–∫ ‚Üí –ø—É–±–ª–∏–∫–∞—Ü–∏—è –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫.

3.3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ pipeline –ø–æ–¥–∞—á–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è:

–ü–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –æ–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–∞ backend:

–≤—ã–∑–≤–∞—Ç—å ModerationService.checkAd,

—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è:

moderationStatus: 'ok' | 'review' | 'blocked',

moderationRiskScore,

moderationReasons.

3.4. Admin-–ø–∞–Ω–µ–ª—å:

–°–¥–µ–ª–∞—Ç—å —Ä–∞–∑–¥–µ–ª:

"–ú–æ–¥–µ—Ä–∞—Ü–∏—è AI":

–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å:

—Å–ø–∏—Å–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–π —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º:

"–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏",

"–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ AI",

"–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫".

–∫—Ä–∞—Ç–∫–∏–π –≤–∏–¥:

–∑–∞–≥–æ–ª–æ–≤–æ–∫,

–∫–∞—Ç–µ–≥–æ—Ä–∏—è,

—Ü–µ–Ω–∞,

–∫—É—Å–æ—á–µ–∫ –æ–ø–∏—Å–∞–Ω–∏—è,

riskScore,

reasons.

–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç:

—É—Ç–≤–µ—Ä–¥–∏—Ç—å (approve),

–æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å,

–æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç,

–¥–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å AI (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

====================================================================
4. –ï–î–ò–ù–´–ô AI-GATEWAY –ù–ê –ë–≠–ö–ï–ù–î–ï
–°–¥–µ–ª–∞—Ç—å –≤ backend –º–æ–¥—É–ª—å/—Å–ª–æ–π –≤–∏–¥–∞ AiGateway:

—ç—Ç–æ –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—É—é:

AiTextService,

RecommendationService,

ModerationService,

–≤ –±—É–¥—É—â–µ–º —á—Ç–æ —É–≥–æ–¥–Ω–æ.

–ü—Ä–∏–º–µ—Ä:

ts
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
class AiGateway {
  text: AiTextService;
  recommend: RecommendationService;
  moderation: ModerationService;

  constructor(...) {
    // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
  }
}
–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–¥–∏–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö,
—á—Ç–æ–±—ã –≤ –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –±—ã–ª–æ:

–∑–∞–º–µ–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –Ω–∞ –≤–Ω–µ—à–Ω–µ–µ API (OpenAI, —Å–≤–æ–π ML-—Å–µ—Ä–≤–∏—Å),

–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã/–æ—Ç–≤–µ—Ç—ã –≤ –æ–¥–Ω–æ–π —Ç–æ—á–∫–µ.

====================================================================
5. –°–ë–û–† –î–ê–ù–ù–´–• –î–õ–Ø ML (–ù–ê –ë–£–î–£–©–ï–ï)
–ü—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ—Ç—å –≤ backend:

–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫—É—é —Ç–∞–±–ª–∏—Ü—É/–∫–æ–ª–ª–µ–∫—Ü–∏—é AdEvents:

ts
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
interface AdEvent {
  _id: ObjectId;
  adId: ObjectId;
  userId?: ObjectId;
  type: 'view' | 'favorite' | 'contact_click' | 'search_click';
  createdAt: Date;
  meta?: Record<string, any>;
}
–°–æ–±—ã—Ç–∏—è –ø–∏—Å–∞—Ç—å:

–ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –∫–∞—Ä—Ç–æ—á–∫–∏ (view),

–ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ (favorite),

–ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º (contact_click),

–ø—Ä–∏ –∫–ª–∏–∫–µ –∏–∑ –ø–æ–∏—Å–∫–∞ (search_click).

–≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –Ω—É–∂–Ω—ã:

–¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π,

–¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–π,

–¥–ª—è –±—É–¥—É—â–µ–≥–æ ML (–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π).

====================================================================
6. –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –ù–ï –õ–û–ú–ê–ï–ú –°–£–©–ï–°–¢–í–£–Æ–©–ï–ï
–û—á–µ–Ω—å –≤–∞–∂–Ω–æ:

–ù–ï –ª–æ–º–∞—Ç—å —Ç–µ–∫—É—â—É—é –ª–æ–≥–∏–∫—É –ø–æ–¥–∞—á–∏ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π,

–≤—Å—ë –Ω–æ–≤–æ–µ ‚Äî –¥–µ–ª–∞—Ç—å –∫–∞–∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ:

–Ω–æ–≤—ã–µ endpoint‚Äô—ã /api/ai/..., /api/recommendations/...,

–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ handler‚Äô—ã ‚Äî —á–µ—Ä–µ–∑ –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–µ –≤—ã–∑–æ–≤—ã AiGateway.

–ù–∏–∫–∞–∫–∏—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ "–≤ –ª–æ–±":

–µ—Å–ª–∏ ModerationService —Å–æ–º–Ω–µ–≤–∞–µ—Ç—Å—è ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Ä—É—á–Ω—É—é –º–æ–¥–µ—Ä–∞—Ü–∏—é, –∞ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–ø—Ä–µ—â–∞–µ–º.

====================================================================
7. UX-–ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –í MINIAPP
–ù–∞ —Ñ—Ä–æ–Ω—Ç–µ (MiniApp):

–í –ø–æ–¥–∞—á–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è:

—á–∏–ø ¬´–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫¬ª,

¬´–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ¬ª,

–±–µ–π–¥–∂: ¬´AI –ø–æ–º–æ–≥ –≤–∞–º –æ—Ñ–æ—Ä–º–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ¬ª (–Ω–µ–Ω–∞–≤—è–∑—á–∏–≤–æ).

–í –ª–µ–Ω—Ç–µ:

—Å–µ–∫—Ü–∏—è ¬´–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–∞–º —Ä—è–¥–æ–º¬ª (–∏—Å—Ö–æ–¥—è –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏),

–ø–ª–∞—à–∫–∞ ¬´–ü–æ—Ö–æ–∂–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è¬ª.

–í –∫–∞—Ä—Ç–æ—á–∫–µ:

–±–ª–æ–∫ ¬´–ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã —Ä—è–¥–æ–º¬ª,

–ø–ª–∞—à–∫–∞ ¬´–ù–∞ –æ—Å–Ω–æ–≤–µ —Ç–æ–≥–æ, —á—Ç–æ –≤—ã —Å–º–æ—Ç—Ä–µ–ª–∏¬ª.

–í –ø—Ä–æ—Ñ–∏–ª–µ:

–æ–ø—Ü–∏—è –≤–∫–ª—é—á–∏—Ç—å/–æ—Ç–∫–ª—é—á–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (GDPR-—Ñ—Ä–µ–Ω–¥–ª–∏).

====================================================================
8. –ò–¢–û–ì
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:

AiTextService + endpoint‚Äô—ã –∞–≤—Ç–æ–æ–ø–∏—Å–∞–Ω–∏—è/–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤/—Ç–µ–≥–æ–≤.

RecommendationService + –ø–æ—Ö–æ–∂–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è + –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –ª–µ–Ω—Ç–∞.

ModerationService + AI-–ø—Ä–µ–¥–º–æ–¥–µ—Ä–∞—Ü–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π (—Å–ø–∞–º/—Ä–∏—Å–∫/–∑–∞–ø—Ä–µ—â—ë–Ω–∫–∞).

AiGateway –∫–∞–∫ –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –¥–æ—Å—Ç—É–ø–∞.

–°–±–æ—Ä —Å–æ–±—ã—Ç–∏–π –¥–ª—è –±—É–¥—É—â–µ–≥–æ ML (AdEvents).

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –≤—Å–µ—Ö —ç—Ç–∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π:

–≤ —Ñ–æ—Ä–º—É –ø–æ–¥–∞—á–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è,

–≤ –ª–µ–Ω—Ç—É,

–≤ –∫–∞—Ä—Ç–æ—á–∫—É,

–≤ –∞–¥–º–∏–Ω–∫—É (–º–æ–¥–µ—Ä–∞—Ü–∏—è + –∞–Ω–∞–ª–∏—Ç–∏–∫–∞).

–ù–∞–ø–∏—Å–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ README (–∫–∞–∫ –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å AI-—Å–ª–æ–π, –≥–¥–µ —Ä–∞—Å—à–∏—Ä—è—Ç—å).

–ö–æ–¥ ‚Äî TypeScript, –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, —á–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞.
–°–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã —Ç–µ–∫—É—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø—Ä–æ–¥–æ–ª–∂–∏–ª —Ä–∞–±–æ—Ç–∞—Ç—å,
–∞ AI-—Å–ª–æ–π –±—ã–ª –ø–ª—é—Å–æ–º —Å–≤–µ—Ä—Ö—É, –∞ –Ω–µ "–ª–æ–º–∞—é—â–∏–º —è–¥—Ä–æ" –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º.