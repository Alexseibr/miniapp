üß© –ß–∞—Å—Ç—å 1 ‚Äî –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ Debian 12
apt update && apt upgrade -y
apt install -y curl wget git ufw nano htop unzip ca-certificates lsb-release gnupg

‚öô Node.js 20
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt install -y nodejs

üê≥ Docker + Docker Compose
curl -fsSL https://download.docker.com/linux/debian/gpg | gpg --dearmor -o /usr/share/keyrings/docker.gpg

echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker.gpg] \
https://download.docker.com/linux/debian $(lsb_release -cs) stable" \
> /etc/apt/sources.list.d/docker.list

apt update
apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

curl -L "https://github.com/docker/compose/releases/download/v2.24.0/docker-compose-$(uname -s)-$(uname -m)" \
-o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose

üçÉ MongoDB 7
curl -fsSL https://pgp.mongodb.com/server-7.0.asc | \
gpg -o /usr/share/keyrings/mongodb-server-7.0.gpg --dearmor

echo "deb [ signed-by=/usr/share/keyrings/mongodb-server-7.0.gpg ] \
https://repo.mongodb.org/apt/debian bookworm/mongodb-org/7.0 main" \
> /etc/apt/sources.list.d/mongodb-org-7.0.list

apt update
apt install -y mongodb-org
systemctl enable mongod
systemctl start mongod

üî¥ Redis
apt install -y redis-server
sed -i 's/supervised no/supervised systemd/' /etc/redis/redis.conf
systemctl restart redis-server
systemctl enable redis-server

üîê Firewall
ufw allow 22
ufw allow 80
ufw allow 443
ufw enable

üåê Nginx
apt install -y nginx
systemctl enable nginx
systemctl start nginx

üß© –ß–∞—Å—Ç—å 2 ‚Äî –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ structure
mkdir -p /var/www/ketmar
cd /var/www/ketmar


–û–∂–∏–¥–∞–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

/var/www/ketmar
  ‚îú‚îÄ backend/
  ‚îú‚îÄ frontend/
  ‚îî‚îÄ docker-compose.yml


–ï—Å–ª–∏ –∫–æ–¥ –≤ GitHub, –≤—ã–ø–æ–ª–Ω–∏—Ç—å:

git clone https://github.com/YOUR_REPO.git project
mv project/backend ./backend
mv project/frontend ./frontend
rm -rf project

üß© –ß–∞—Å—Ç—å 3 ‚Äî Dockerfile –¥–ª—è backend

/var/www/ketmar/backend/Dockerfile

FROM node:20-alpine

WORKDIR /app

COPY package*.json ./
RUN npm install --only=production || npm install

COPY . .

ENV PORT=3000
EXPOSE 3000

CMD ["npm", "run", "start"]

üß© –ß–∞—Å—Ç—å 4 ‚Äî Dockerfile –¥–ª—è frontend (Vite/React)

/var/www/ketmar/frontend/Dockerfile

FROM node:20-alpine AS build
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=build /app/dist /usr/share/nginx/html
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]

üß© –ß–∞—Å—Ç—å 5 ‚Äî docker-compose.yml

/var/www/ketmar/docker-compose.yml

version: "3.9"

services:
  mongo:
    image: mongo:7
    container_name: ketmar-mongo
    restart: always
    environment:
      MONGO_INITDB_ROOT_USERNAME: ketmar_root
      MONGO_INITDB_ROOT_PASSWORD: super_secure_pass
    ports:
      - "27017:27017"
    volumes:
      - mongo_data:/data/db
    networks:
      - ketmar-net

  redis:
    image: redis:7-alpine
    container_name: ketmar-redis
    restart: always
    command: ["redis-server", "--appendonly", "yes"]
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    networks:
      - ketmar-net

  api:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: ketmar-api
    restart: always
    env_file:
      - ./backend/.env
    environment:
      MONGO_URL: "mongodb://ketmar_root:super_secure_pass@mongo:27017/ketmar?authSource=admin"
      REDIS_URL: "redis://redis:6379/0"
      NODE_ENV: "production"
    depends_on:
      - mongo
      - redis
    ports:
      - "3000:3000"
    networks:
      - ketmar-net

  web:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: ketmar-web
    restart: always
    env_file:
      - ./frontend/.env
    ports:
      - "5173:80"
    depends_on:
      - api
    networks:
      - ketmar-net

volumes:
  mongo_data:
  redis_data:

networks:
  ketmar-net:
    driver: bridge

üß© –ß–∞—Å—Ç—å 6 ‚Äî –ó–∞–ø—É—Å–∫
cd /var/www/ketmar
docker-compose up -d --build
docker ps


–î–æ–ª–∂–Ω—ã –ø–æ–¥–Ω—è—Ç—å—Å—è:

ketmar-web

ketmar-api

ketmar-mongo

ketmar-redis

üß© –ß–∞—Å—Ç—å 7 ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞ ketmar.by (Hoster.by)
–í –ø–∞–Ω–µ–ª–∏ hoster.by ‚Üí DNS:

–ó–∞–ø–æ–ª–Ω–∏ A-–∑–∞–ø–∏—Å–∏:

app.ketmar.by ‚Üí YOUR_SERVER_IP
api.ketmar.by ‚Üí YOUR_SERVER_IP
ketmar.by     ‚Üí YOUR_SERVER_IP
www.ketmar.by ‚Üí YOUR_SERVER_IP


TTL –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å 300‚Äì600.

üß© –ß–∞—Å—Ç—å 8 ‚Äî Nginx –ø–æ–¥ –¥–æ–º–µ–Ω—ã
1) API ‚Äî api.ketmar.by
nano /etc/nginx/sites-available/api.ketmar.by


–í—Å—Ç–∞–≤–∏—Ç—å:

server {
    listen 80;
    server_name api.ketmar.by;

    location / {
        proxy_pass http://127.0.0.1:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}


–ê–∫—Ç–∏–≤–∏—Ä—É–µ–º:

ln -s /etc/nginx/sites-available/api.ketmar.by /etc/nginx/sites-enabled/

2) Web/Miniapp ‚Äî app.ketmar.by
nano /etc/nginx/sites-available/app.ketmar.by


–í—Å—Ç–∞–≤–∏—Ç—å:

server {
    listen 80;
    server_name app.ketmar.by;

    location / {
        proxy_pass http://127.0.0.1:5173;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}


–ê–∫—Ç–∏–≤–∏—Ä—É–µ–º:

ln -s /etc/nginx/sites-available/app.ketmar.by /etc/nginx/sites-enabled/

3) –ì–ª–∞–≤–Ω—ã–π –¥–æ–º–µ–Ω ‚Äî ketmar.by
nano /etc/nginx/sites-available/ketmar.by


–í—Å—Ç–∞–≤–∏—Ç—å:

server {
    listen 80;
    server_name ketmar.by www.ketmar.by;

    location / {
        return 301 https://app.ketmar.by;
    }
}


–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å:

ln -s /etc/nginx/sites-available/ketmar.by /etc/nginx/sites-enabled/

–ü—Ä–æ–≤–µ—Ä–∫–∞ + –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ Nginx
nginx -t
systemctl reload nginx

üß© –ß–∞—Å—Ç—å 9 ‚Äî HTTPS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (Let‚Äôs Encrypt)

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

apt install -y certbot python3-certbot-nginx


–í—ã–¥–∞—á–∞:

certbot --nginx -d api.ketmar.by
certbot --nginx -d app.ketmar.by
certbot --nginx -d ketmar.by -d www.ketmar.by

üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è:

API —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ ‚Üí https://api.ketmar.by

MiniApp/web —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí https://app.ketmar.by

–ì–ª–∞–≤–Ω—ã–π –¥–æ–º–µ–Ω ketmar.by —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç ‚Üí app.ketmar.by

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã –≤ Docker

MongoDB + Redis –ø–æ–¥–Ω—è—Ç—ã

HTTPS —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

–°–µ—Ä–≤–µ—Ä Production-ready