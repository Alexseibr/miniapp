Ты — frontend-разработчик (React + TypeScript) в проекте KETMAR Market.

БЭКЕНД УЖЕ ДАЁТ нам упрощённые данные по ценовой аналитике (для каждого объявления):

interface PriceBadge {
  hasMarketData: boolean;
  marketLevel: 'below' | 'fair' | 'above' | 'unknown';
  diffPercent?: number | null;  // может быть отрицательным / положительным
}

Эти данные либо приходят внутри объекта `Ad` (поле `priceBadge`), либо отдельным объектом, который пробрасывается в карточку.

ТВОЯ ЗАДАЧА — СДЕЛАТЬ ТОЛЬКО UI:

1) маленькие бейджи на карточке объявления в ленте,
2) блок “Цена vs рынок” на экране детали объявления,
3) ненавязчивый подсказочный блок для продавца в форме редактирования цены.

Никаких запросов к API — только компоненты и отображение.

================================
1. КОМПОНЕНТ PriceBadgeChip (карточка)
================================

Создай универсальный компонент, например:

`miniapp/src/components/pricing/PriceBadgeChip.tsx`

API:

```ts
interface PriceBadgeChipProps {
  badge: PriceBadge | null | undefined;
  size?: 'small' | 'medium'; // по умолчанию small
}
ЛОГИКА ТЕКСТА:

если !badge или !badge.hasMarketData → ничего не рендерить (null).

если badge.marketLevel === 'below' && badge.diffPercent <= -3:

текст: Ниже рынка на {abs(diffPercent)}%

если marketLevel === 'fair' или |diffPercent| < 3:

текст: Цена по рынку

если marketLevel === 'above' && badge.diffPercent >= 5:

текст: Выше рынка на {diffPercent}%

если unknown → можно не показывать.

ОКРУГЛЕНИЕ:

diffPercent показывать без знака, 0–1 знак после запятой:

Math.round(Math.abs(diffPercent) * 10) / 10.

СТИЛИ:

Общий вид: pill-бейдж, border-radius ~9999, padding по горизонтали 8–10, по вертикали 2–4.

Цвета:

Ниже рынка:

фон: мягкий зелёный (mint/light green),

текст: тёмно-зелёный,

маленькая иконка “стрелка вниз” или “галочка”.

По рынку:

фон: светло-серый/нейтральный,

текст: тёмно-серый,

иконка: “≈” или “баланс”.

Выше рынка:

фон: мягкий оранжевый/жёлтый,

текст: тёмно-оранжевый,

иконка: “стрелка вверх”.

Вариант size="small":

шрифт: 11–12px,

высота бейджа небольшая.

Вариант size="medium":

шрифт: 13–14px,

чуть больше padding.

================================
2. ВСТРАИВАНИЕ В КАРТОЧКУ ОБЪЯВЛЕНИЯ
Найди компонент карточки объявления в ленте (например AdCardSmall / AdCard).

Сделай так:

В верхней части карточки (под фото или правый верхний угол блока с ценой):

вывести <PriceBadgeChip badge={ad.priceBadge} size="small" />.

Пример структуры:

Цена и бейдж:

[ 2 900 BYN ]
[ <PriceBadgeChip> ]

или:

[Цена] [бейдж справа].

Главное — бейдж должен хорошо читаться, но не перебивать цену.

================================
3. БЛОК НА ДЕТАЛЯХ ОБЪЯВЛЕНИЯ
Создай компонент:

miniapp/src/components/pricing/PriceMarketBlock.tsx

API:

ts
Копировать код
interface PriceMarketBlockProps {
  badge: PriceBadge | null | undefined;
  avgPrice?: number | null;      // средняя цена по рынку (если фронт её уже получает)
  windowDays?: number | null;    // за сколько дней считали
  categorySlug: string;
  price: number;
  pricePerSqm?: number | null;   // для квартир, если есть
}
Поведение:

Если !badge || !badge.hasMarketData → вернуть null.

Иначе отрисовать аккуратную карточку (full-width):

Структура:

Заголовок (жирный):

"Цена и рынок"

Основная строка:

"Текущая цена: 2 900 BYN"

Если есть pricePerSqm:

"Это 1 250 BYN/м²"

Дальше блок в 2–3 строки:

"Средняя цена по похожим объявлениям: 2 850 BYN"

"Период анализа: последние 30 дней" (если есть windowDays)

Встроенный <PriceBadgeChip badge={badge} size="medium" />

Доп. текст по статусу:

Ниже рынка:

"Это выгоднее, чем средняя цена на похожие объявления на {abs(diffPercent)}%."

По рынку:

"Цена примерно соответствует средней по рынку."

Выше рынка:

"Цена выше средней на {diffPercent}%. Покупатели могут сравнить с другими объявлениями." (очень нейтрально).

Стили:

Карточка с лёгкой тенью и закруглением.

Небольшой отступ сверху/снизу.

Текст крупный и понятный.

================================
4. ПОДСКАЗКА ДЛЯ ПРОДАВЦА ПРИ ВВОДЕ ЦЕНЫ
В форме подачи/редактирования объявления найди компонент с полем “Цена”.

Сделай мини-компонент:

miniapp/src/components/pricing/PriceHintForSeller.tsx

API:

ts
Копировать код
interface PriceHintForSellerProps {
  badge: PriceBadge | null | undefined;
  avgPrice?: number | null;
  windowDays?: number | null;
  price: number; // текущая введённая цена
}
Поведение:

Если нет данных (нет badge / avgPrice) → можно показать только маленький текст:

"Пока недостаточно данных для анализа цены." — и всё.

Если есть:

Выводить под полем “Цена” небольшую подсказку (НЕ как ошибка, а как инфобокс):

Варианты текстов:

Если ниже рынка (below):

"Средняя цена на похожие объявления: 2 850 BYN (за последние 30 дней)."

"Ваша цена ниже средней на 5%. Это может помочь продать быстрее."

Если по рынку (fair):

"Средняя цена на похожие объявления: 2 850 BYN."

"Ваша цена примерно соответствует рынку."

Если выше рынка (above):

"Средняя цена на похожие объявления: 2 850 BYN."

"Ваша цена выше средней на 12%. Можно снизить, чтобы привлечь больше интереса."

Стили:

Лёгкий голубой/серый фон, иконка информации, текст 12–13px.

НЕ использовать красный цвет, чтобы не воспринималось как ошибка.

================================
5. ОБЩИЕ МЕЛОЧИ
Везде, где отображаешь проценты:

форматировать через helper:

ts
Копировать код
function formatPercent(value: number): string {
  const abs = Math.abs(value);
  if (abs < 0.1) return 'менее 0.1';
  return abs.toFixed(abs >= 10 ? 0 : 1);
}
Использовать: Ниже рынка на {formatPercent(diffPercent)}%.

Все компоненты должны быть «чистыми»:

никакого fetch внутри,

только рендер на основе пропсов.

TypeScript:

без any,

аккуратные интерфейсы.

================================
6. ВСТАВЬ В КОД И КОРОТКО ОТЧИТАЙСЯ
После реализации:

Используй PriceBadgeChip в:

карточке объявления в ленте,

возможно, в блоке “найдено X объявлений” (опционально).

Используй PriceMarketBlock на экранe деталей объявления.

Используй PriceHintForSeller под полем цены в форме подачи/редактирования.

В конце распиши, какие файлы создал/обновил и что там сделал.