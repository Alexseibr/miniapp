import mongoose from 'mongoose';
import Category from '../models/Category.js';
import * as config from '../config/config.js';

const KEYWORD_MAPPINGS = {
  // –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞
  'elektronika': ['—ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞', '—Ç–µ—Ö–Ω–∏–∫–∞', '—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞', '–≥–∞–¥–∂–µ—Ç—ã', '–¥–µ–≤–∞–π—Å—ã'],
  'telefony-planshety': ['—Ç–µ–ª–µ—Ñ–æ–Ω', '—Å–º–∞—Ä—Ç—Ñ–æ–Ω', '–ø–ª–∞–Ω—à–µ—Ç', '–∞–π—Ñ–æ–Ω', 'iphone', 'samsung', 'xiaomi', '—Ç–µ–ª–µ—Ñ–æ–Ω—ã', '–º–æ–±–∏–ª—å–Ω—ã–π', '—Å–æ—Ç–æ–≤—ã–π', '–∞–π–ø–∞–¥', 'ipad', '–∞–Ω–¥—Ä–æ–∏–¥', 'android'],
  'smartfony': ['—Å–º–∞—Ä—Ç—Ñ–æ–Ω', '—Ç–µ–ª–µ—Ñ–æ–Ω', '–∞–π—Ñ–æ–Ω', 'iphone', 'samsung', 'xiaomi', '–º–æ–±–∏–ª—å–Ω—ã–π', '—Å–æ—Ç–æ–≤—ã–π', '–∞–Ω–¥—Ä–æ–∏–¥'],
  'planshety': ['–ø–ª–∞–Ω—à–µ—Ç', '–∞–π–ø–∞–¥', 'ipad', 'tablet', '–∞–Ω–¥—Ä–æ–∏–¥ –ø–ª–∞–Ω—à–µ—Ç'],
  'noutbuki-kompyutery': ['–Ω–æ—É—Ç–±—É–∫', '–º–∞–∫–±—É–∫', 'macbook', 'laptop', '–∫–æ–º–ø—å—é—Ç–µ—Ä', '–Ω–æ—É—Ç–±—É–∫–∏', '–ª–∞–ø—Ç–æ–ø', '—É–ª—å—Ç—Ä–∞–±—É–∫'],
  'tv-foto-video': ['—Ç–µ–ª–µ–≤–∏–∑–æ—Ä', '—Ç–≤', 'tv', '–∫–∞–º–µ—Ä–∞', '—Ñ–æ—Ç–æ–∞–ø–ø–∞—Ä–∞—Ç', '–≤–∏–¥–µ–æ–∫–∞–º–µ—Ä–∞', '—Ç–µ–ª–µ–∫', '–∑–µ—Ä–∫–∞–ª–∫–∞', 'gopro'],
  'audio-tehnika': ['–Ω–∞—É—à–Ω–∏–∫–∏', '–∫–æ–ª–æ–Ω–∫–∏', '–∞—É–¥–∏–æ', '–∑–≤—É–∫', '–∞–∫—É—Å—Ç–∏–∫–∞', '–º—É–∑—ã–∫–∞–ª—å–Ω—ã–π —Ü–µ–Ω—Ç—Ä', '–¥–∏–Ω–∞–º–∏–∫–∏', '—Å–∞—É–Ω–¥–±–∞—Ä', '–Ω–∞—É—à–Ω–∏–∫'],
  'igry-igrovye-pristavki': ['–ø—Ä–∏—Å—Ç–∞–≤–∫–∞', 'playstation', 'xbox', 'nintendo', '–∏–≥—Ä–æ–≤–∞—è –∫–æ–Ω—Å–æ–ª—å', 'ps5', 'ps4', '–ø—Ä–∏—Å—Ç–∞–≤–∫–∞ –∏–≥—Ä–æ–≤–∞—è', '–∫–æ–Ω—Å–æ–ª—å'],
  
  // –ê–≤—Ç–æ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç
  'avto-zapchasti': ['–∞–≤—Ç–æ', '–∞–≤—Ç–æ–º–æ–±–∏–ª—å', '–º–∞—à–∏–Ω–∞', '—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç', '—Ç–∞—á–∫–∞', '–∞–≤—Ç–æ–º–∞—à–∏–Ω–∞'],
  'legkovye-avtomobili': ['–∞–≤—Ç–æ–º–æ–±–∏–ª—å', '–º–∞—à–∏–Ω–∞', '–∞–≤—Ç–æ', '–ª–µ–≥–∫–æ–≤–æ–π', '–ª–µ–≥–∫–æ–≤—É—à–∫–∞', 'bmw', 'audi', 'mercedes', 'toyota', '—Ç–∞—á–∫–∞', '–∞–≤—Ç–æ–º–∞—à–∏–Ω–∞', '–ª–µ–≥–∫–æ–≤–∞—è'],
  'sedan': ['—Å–µ–¥–∞–Ω', '–∞–≤—Ç–æ–º–æ–±–∏–ª—å —Å–µ–¥–∞–Ω', '–ª–µ–≥–∫–æ–≤–æ–π —Å–µ–¥–∞–Ω'],
  'vnedorozhnik': ['–≤–Ω–µ–¥–æ—Ä–æ–∂–Ω–∏–∫', '–¥–∂–∏–ø', 'jeep', 'suv', '–∫—Ä–æ—Å—Å–æ–≤–µ—Ä'],
  'mototehnika': ['–º–æ—Ç–æ—Ü–∏–∫–ª', '–º–æ—Ç–æ', '–±–∞–π–∫', '—Å–∫—É—Ç–µ—Ä', '–º–æ–ø–µ–¥', '–º–æ—Ç–æ—Ä–æ–ª–ª–µ—Ä'],
  'gruzovye-avtomobili': ['–≥—Ä—É–∑–æ–≤–∏–∫', '—Ñ—É—Ä–∞', '–∫–∞–º–∞–∑', '–≥—Ä—É–∑–æ–≤–æ–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å', '–≥—Ä—É–∑–æ–≤–æ–π', '–≥–∞–∑–µ–ª—å'],
  'zapchasti-aksessuary': ['–∑–∞–ø—á–∞—Å—Ç–∏', '–¥–µ—Ç–∞–ª–∏', '–∞–≤—Ç–æ–∑–∞–ø—á–∞—Å—Ç–∏', '–∑/—á', '–∑–∞–ø—á–∞—Å—Ç—å', '–¥–µ—Ç–∞–ª–∏ –¥–ª—è –∞–≤—Ç–æ', '–∞–≤—Ç–æ–¥–µ—Ç–∞–ª–∏'],
  'shiny-diski': ['—à–∏–Ω—ã', '–¥–∏—Å–∫–∏', '–∫–æ–ª–µ—Å–∞', '—Ä–µ–∑–∏–Ω–∞', '–ø–æ–∫—Ä—ã—à–∫–∏', '–∫–æ–ª—ë—Å–∞', '–∞–≤—Ç–æ—à–∏–Ω—ã'],
  'aksessuary': ['–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã', '–∞–≤—Ç–æ–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã', '—á–µ—Ö–ª—ã', '–∫–æ–≤—Ä–∏–∫–∏', '–∞–≤—Ç–æ—á–µ—Ö–ª—ã'],
  
  // –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å
  'nedvizhimost': ['–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å', '–∫–≤–∞—Ä—Ç–∏—Ä–∞', '–¥–æ–º', '–∂–∏–ª—å–µ', '–∂–∏–ª—å—ë', '–∂–∏–ª–∞—è –ø–ª–æ—â–∞–¥—å'],
  'kvartiry': ['–∫–≤–∞—Ä—Ç–∏—Ä–∞', '–∫–≤–∞—Ä—Ç–∏—Ä—ã', '–∫–≤–∞—Ä—Ç–∏—Ä–∞ –∫—É–ø–∏—Ç—å', '–ø—Ä–æ–¥–∞–∂–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã', '–∫–≤', '–∫–≤–∞—Ä—Ç–∏—Ä–∫–∞'],
  '1-komnatnye': ['–æ–¥–Ω–æ–∫–æ–º–Ω–∞—Ç–Ω–∞—è', '1-–∫–æ–º–Ω–∞—Ç–Ω–∞—è', '1 –∫–æ–º–Ω–∞—Ç–Ω–∞—è', '–æ–¥–Ω—É—à–∫–∞', '1-–∫'],
  '2-komnatnye': ['–¥–≤—É—Ö–∫–æ–º–Ω–∞—Ç–Ω–∞—è', '2-–∫–æ–º–Ω–∞—Ç–Ω–∞—è', '2 –∫–æ–º–Ω–∞—Ç–Ω–∞—è', '–¥–≤—É—à–∫–∞', '2-–∫'],
  '3-komnatnye': ['—Ç—Ä–µ—Ö–∫–æ–º–Ω–∞—Ç–Ω–∞—è', '3-–∫–æ–º–Ω–∞—Ç–Ω–∞—è', '3 –∫–æ–º–Ω–∞—Ç–Ω–∞—è', '—Ç—Ä—ë—à–∫–∞', '3-–∫'],
  'studii': ['—Å—Ç—É–¥–∏—è', '–∫–≤–∞—Ä—Ç–∏—Ä–∞ —Å—Ç—É–¥–∏—è', '—Å—Ç—É–¥–∏–æ'],
  'doma-dachi-kottedzhi': ['–¥–æ–º', '–∫–æ—Ç—Ç–µ–¥–∂', '–¥–æ–º –∫—É–ø–∏—Ç—å', '–ø—Ä–æ–¥–∞–∂–∞ –¥–æ–º–∞', '–∫–æ—Ç—Ç–µ–¥–∂–∏–∫', '–¥–æ–º–∏–∫', '–¥–∞—á–∞'],
  'uchastki': ['—É—á–∞—Å—Ç–æ–∫', '–∑–µ–º–ª—è', '–∑–µ–º–µ–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫', '–Ω–∞–¥–µ–ª', '–∑–µ–º–ª–∏—Ü–∞'],
  'kommercheskaya-nedvizhimost': ['–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å', '–æ—Ñ–∏—Å', '—Ç–æ—Ä–≥–æ–≤–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ', '–ø–æ–º–µ—â–µ–Ω–∏–µ', '–∫–æ–º–º–µ—Ä—Ü–∏—è'],
  'realty_rent': ['–∞—Ä–µ–Ω–¥–∞', '—Å–Ω—è—Ç—å', '—Å–¥–∞—Ç—å', '–∞—Ä–µ–Ω–¥–æ–≤–∞—Ç—å', '—Å—ä–µ–º'],
  'realty_rent_daily': ['–ø–æ—Å—É—Ç–æ—á–Ω–æ', '—Å—É—Ç–∫–∏', '—Å—É—Ç–æ—á–Ω–∞—è –∞—Ä–µ–Ω–¥–∞', '–ø–æ—Å—É—Ç–æ—á–Ω–∞—è'],
  'realty_rent_long': ['–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –∞—Ä–µ–Ω–¥–∞', '–¥–ª–∏—Ç–µ–ª—å–Ω–∞—è –∞—Ä–µ–Ω–¥–∞', '–Ω–∞ –¥–æ–ª–≥–∏–π —Å—Ä–æ–∫'],
  
  // –û–¥–µ–∂–¥–∞ –∏ –æ–±—É–≤—å
  'odezhda-obuv': ['–æ–¥–µ–∂–¥–∞', '–æ–±—É–≤—å', '–≤–µ—â–∏', '–≥–∞—Ä–¥–µ—Ä–æ–±', '–æ–¥—ë–∂–∫–∞'],
  'zhenskaya-odezhda': ['–∂–µ–Ω—Å–∫–∞—è –æ–¥–µ–∂–¥–∞', '–ø–ª–∞—Ç—å–µ', '—é–±–∫–∞', '–±–ª—É–∑–∫–∞', '–∂–µ–Ω—Å–∫–æ–µ', '–¥–ª—è –∂–µ–Ω—â–∏–Ω', '–∫–æ—Ñ—Ç–æ—á–∫–∞', '—à—Ç–∞–Ω—ã –∂–µ–Ω—Å–∫–∏–µ'],
  'muzhskaya-odezhda': ['–º—É–∂—Å–∫–∞—è –æ–¥–µ–∂–¥–∞', '—Ä—É–±–∞—à–∫–∞', '–±—Ä—é–∫–∏', '–∫–æ—Å—Ç—é–º', '–º—É–∂—Å–∫–æ–µ', '–¥–ª—è –º—É–∂—á–∏–Ω', '–ø–∏–¥–∂–∞–∫', '—à—Ç–∞–Ω—ã –º—É–∂—Å–∫–∏–µ'],
  'detskaya-odezhda': ['–¥–µ—Ç—Å–∫–∞—è –æ–¥–µ–∂–¥–∞', '–¥–µ—Ç—Å–∫–æ–µ', '–¥–ª—è –¥–µ—Ç–µ–π', '–æ–¥–µ–∂–¥–∞ –¥–ª—è —Ä–µ–±–µ–Ω–∫–∞'],
  'zhenskaya-obuv': ['–æ–±—É–≤—å –∂–µ–Ω—Å–∫–∞—è', '—Ç—É—Ñ–ª–∏', '–±–æ—Ç–∏–Ω–∫–∏ –∂–µ–Ω—Å–∫–∏–µ', '—Å–∞–ø–æ–≥–∏', '–±–æ—Å–æ–Ω–æ–∂–∫–∏', '–∂–µ–Ω—Å–∫–∞—è –æ–±—É–≤—å'],
  'muzhskaya-obuv': ['–æ–±—É–≤—å –º—É–∂—Å–∫–∞—è', '–±–æ—Ç–∏–Ω–∫–∏', '–∫—Ä–æ—Å—Å–æ–≤–∫–∏ –º—É–∂—Å–∫–∏–µ', '—Ç—É—Ñ–ª–∏ –º—É–∂—Å–∫–∏–µ', '–º—É–∂—Å–∫–∞—è –æ–±—É–≤—å'],
  'detskaya-obuv': ['–æ–±—É–≤—å –¥–µ—Ç—Å–∫–∞—è', '–¥–µ—Ç—Å–∫–∞—è –æ–±—É–≤—å', '–æ–±—É–≤—å –¥–ª—è –¥–µ—Ç–µ–π'],
  
  // –î–æ–º –∏ —Å–∞–¥
  'dom-sad': ['–¥–æ–º', '—Å–∞–¥', '–º–µ–±–µ–ª—å', '–∏–Ω—Ç–µ—Ä—å–µ—Ä', '–¥–ª—è –¥–æ–º–∞'],
  'mebel': ['–º–µ–±–µ–ª—å', '–¥–∏–≤–∞–Ω', '–∫—Ä–æ–≤–∞—Ç—å', '—à–∫–∞—Ñ', '—Å—Ç–æ–ª', '—Å—Ç—É–ª', '—Å–æ—Ñ–∞', '–∫—Ä–µ—Å–ª–æ', '–∫–æ–º–æ–¥', '—Ç—É–º–±–æ—á–∫–∞', '—Å—Ç–µ–ª–ª–∞–∂'],
  'bytovaya-tehnika': ['–±—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞', '—Ç–µ—Ö–Ω–∏–∫–∞ –¥–ª—è –¥–æ–º–∞', '–±—ã—Ç–æ–≤—É—Ö–∞'],
  'krupnaya-bytovaya-tehnika': ['—Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫', '—Å—Ç–∏—Ä–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞', '—Å—Ç–∏—Ä–∞–ª–∫–∞', '—Ö–æ–ª–æ–¥–æ—Å', '–º–æ—Ä–æ–∑–∏–ª–∫–∞'],
  'melkaya-bytovaya-tehnika': ['–º–∏–∫—Ä–æ–≤–æ–ª–Ω–æ–≤–∫–∞', '—á–∞–π–Ω–∏–∫', '—Ç–æ—Å—Ç–µ—Ä', '–º—É–ª—å—Ç–∏–≤–∞—Ä–∫–∞', '–±–ª–µ–Ω–¥–µ—Ä'],
  'rasteniya': ['—Ä–∞—Å—Ç–µ–Ω–∏—è', '—Å–∞–∂–µ–Ω—Ü—ã', '—Å–µ–º–µ–Ω–∞', '–æ–≥–æ—Ä–æ–¥', '—Ü–≤–µ—Ç—ã', '—Ä–∞—Å—Å–∞–¥–∞'],
  'tovary-dlya-sada': ['–¥–ª—è —Å–∞–¥–∞', '—Å–∞–¥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã', '—Å–∞–¥–æ–≤—ã–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å'],
  
  // –î–µ—Ç—Å–∫–∏–µ —Ç–æ–≤–∞—Ä—ã
  'tovary-dlya-detey': ['–¥–µ—Ç—Å–∫–∏–µ', '–¥–µ—Ç—Å–∫–æ–µ', '–¥–ª—è –¥–µ—Ç–µ–π', '—Ä–µ–±–µ–Ω–æ–∫', '–¥–µ—Ç—è–º'],
  'igrushki': ['–∏–≥—Ä—É—à–∫–∏', '–∏–≥—Ä—É—à–∫–∞', '–∏–≥—Ä—ã', '–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä', '–∫—É–±–∏–∫–∏', '–º–∞—à–∏–Ω–∫–∏', '–∫—É–∫–ª—ã'],
  'kolyaski-avtokresla': ['–∫–æ–ª—è—Å–∫–∞', '–∫–æ–ª—è—Å–∫–∏', '–ø—Ä–æ–≥—É–ª–æ—á–Ω–∞—è –∫–æ–ª—è—Å–∫–∞', '–∞–≤—Ç–æ–∫—Ä–µ—Å–ª–æ', '–∫—Ä–µ—Å–ª–æ –≤ –∞–≤—Ç–æ'],
  'detskaya-mebel': ['–¥–µ—Ç—Å–∫–∞—è –º–µ–±–µ–ª—å', '–∫—Ä–æ–≤–∞—Ç–∫–∞', '–º–µ–±–µ–ª—å –¥–ª—è –¥–µ—Ç–µ–π'],
  
  // –ñ–∏–≤–æ—Ç–Ω—ã–µ
  'zhivotnye': ['–∂–∏–≤–æ—Ç–Ω—ã–µ', '–ø–∏—Ç–æ–º—Ü—ã', '–∑–æ–æ—Ç–æ–≤–∞—Ä—ã', '–∂–∏–≤–æ—Ç–Ω–æ–µ', '–ø–∏—Ç–æ–º–µ—Ü'],
  'sobaki': ['—Å–æ–±–∞–∫–∞', '—Å–æ–±–∞–∫–∏', '—â–µ–Ω–æ–∫', '—â–µ–Ω–∫–∏', '–ø–µ—Å', '–ø–µ—Å–∏–∫', '—Å–æ–±–∞—á–∫–∞'],
  'koshki': ['–∫–æ—à–∫–∞', '–∫–æ—à–∫–∏', '–∫–æ—Ç–µ–Ω–æ–∫', '–∫–æ—Ç—è—Ç–∞', '–∫–æ—Ç', '–∫–æ—Ç–∏–∫', '–∫–∏—Å–∞', '–∫–æ—à–µ—á–∫–∞'],
  'ptitsy': ['–ø—Ç–∏—Ü–∞', '–ø—Ç–∏—Ü—ã', '–ø–æ–ø—É–≥–∞–π', '–∫–∞–Ω–∞—Ä–µ–π–∫–∞', '–ø—Ç–∏—á–∫–∞'],
  'akvarium-rybki': ['–∞–∫–≤–∞—Ä–∏—É–º', '—Ä—ã–±–∫–∏', '—Ä—ã–±–∫–∞', '—Ä—ã–±–∞', '–∞–∫–≤–∞—Ä–∏—É–º–Ω—ã–µ —Ä—ã–±–∫–∏'],
  'tovary-dlya-zhivotnykh': ['–∑–æ–æ—Ç–æ–≤–∞—Ä—ã', '—Ç–æ–≤–∞—Ä—ã –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö', '–∫–æ—Ä–º', '–º–∏—Å–∫–∏'],
  
  // –•–æ–±–±–∏ –∏ —Å–ø–æ—Ä—Ç
  'hobbi-sport-turizm': ['—Ö–æ–±–±–∏', '—Å–ø–æ—Ä—Ç', '–æ—Ç–¥—ã—Ö', '—Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è', '—É–≤–ª–µ—á–µ–Ω–∏—è'],
  'sport-otdyh': ['—Å–ø–æ—Ä—Ç', '—Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–µ', '–¥–ª—è —Å–ø–æ—Ä—Ç–∞', '–∞–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö'],
  'trenazhjory': ['—Ç—Ä–µ–Ω–∞–∂–µ—Ä', '–≥–∞–Ω—Ç–µ–ª–∏', '—à—Ç–∞–Ω–≥–∞', '—Ç—Ä–µ–Ω–∞–∂—ë—Ä', '—Å–ø–æ—Ä—Ç–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å'],
  'velosipedy': ['–≤–µ–ª–æ—Å–∏–ø–µ–¥', '–≤–µ–ª–∏–∫', '—Å–∞–º–æ–∫–∞—Ç', '–≤–µ–ª–æ—Å–∏–ø–µ–¥—ã', '–±–∞–π–∫'],
  'oxota-rybalka': ['—Ä—ã–±–∞–ª–∫–∞', '—É–¥–æ—á–∫–∞', '—Å–ø–∏–Ω–Ω–∏–Ω–≥', '—Å–Ω–∞—Å—Ç–∏', '–æ—Ö–æ—Ç–∞', '—Ä—É–∂—å–µ'],
  'muzykalnye-instrumenty': ['–º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã', '–≥–∏—Ç–∞—Ä–∞', '–ø–∏–∞–Ω–∏–Ω–æ', '—Å–∏–Ω—Ç–µ–∑–∞—Ç–æ—Ä'],
  
  // –ö—Ä–∞—Å–æ—Ç–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ
  'krasota-zdorove-tovary': ['–∫—Ä–∞—Å–æ—Ç–∞', '–∑–¥–æ—Ä–æ–≤—å–µ', '–∫–æ—Å–º–µ—Ç–∏–∫–∞', '—É—Ö–æ–¥'],
  'kosmetika-parfyumeriya': ['–∫–æ—Å–º–µ—Ç–∏–∫–∞', '–º–∞–∫–∏—è–∂', '–ø–∞—Ä—Ñ—é–º', '–¥—É—Ö–∏', '–ø–∞—Ä—Ñ—é–º–µ—Ä–∏—è', '–ø–æ–º–∞–¥–∞'],
  'medtekhnika-optika': ['–º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ', '—Ç–æ–Ω–æ–º–µ—Ç—Ä', '—Ç–µ—Ä–º–æ–º–µ—Ç—Ä', '–æ—á–∫–∏', '–ª–∏–Ω–∑—ã'],
  
  // –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –∏ —Ä–µ–º–æ–Ω—Ç
  'remont-stroyka': ['—Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ', '—Ä–µ–º–æ–Ω—Ç', '—Å—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã', '—Å—Ç—Ä–æ–π–∫–∞'],
  'stroitelnye-materialy': ['—Å—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã', '–∫–∏—Ä–ø–∏—á', '—Ü–µ–º–µ–Ω—Ç', '–ø–µ—Å–æ–∫', '–º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞'],
  'instrument': ['–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã', '–¥—Ä–µ–ª—å', '–ø–µ—Ä—Ñ–æ—Ä–∞—Ç–æ—Ä', '—à—É—Ä—É–ø–æ–≤–µ—Ä—Ç', '–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç'],
  'elektroinstrument': ['—ç–ª–µ–∫—Ç—Ä–æ–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç', '–¥—Ä–µ–ª—å', '–ø–µ—Ä—Ñ–æ—Ä–∞—Ç–æ—Ä', '—à—É—Ä—É–ø–æ–≤–µ—Ä—Ç', '–±–æ–ª–≥–∞—Ä–∫–∞'],
  
  // –£—Å–ª—É–≥–∏
  'uslugi': ['—É—Å–ª—É–≥–∏', '—Ä–∞–±–æ—Ç—ã', '—Å–µ—Ä–≤–∏—Å', '—É—Å–ª—É–≥–∞'],
  'stroitelstvo-remont': ['—Ä–µ–º–æ–Ω—Ç', '–ø–æ—á–∏–Ω–∫–∞', '–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ', '—Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã', '–æ—Ç–¥–µ–ª–∫–∞'],
  'obuchenie-kursy': ['—Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä', '–æ–±—É—á–µ–Ω–∏–µ', '—É—Ä–æ–∫–∏', '–∫—É—Ä—Å—ã', '–ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å'],
  'krasota-zdorove': ['–ø–∞—Ä–∏–∫–º–∞—Ö–µ—Ä', '–º–∞–Ω–∏–∫—é—Ä', '–º–∞—Å—Å–∞–∂', '—Å–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã', '—Å—Ç—Ä–∏–∂–∫–∞'],
  
  // –†–∞–±–æ—Ç–∞
  'rabota': ['—Ä–∞–±–æ—Ç–∞', '–≤–∞–∫–∞–Ω—Å–∏—è', '–≤–∞–∫–∞–Ω—Å–∏–∏', '—Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ', 'job'],
  'vakansii': ['–≤–∞–∫–∞–Ω—Å–∏—è', '–≤–∞–∫–∞–Ω—Å–∏–∏', '—Ä–∞–±–æ—Ç–∞', '–∏—â—É —Ä–∞–±–æ—Ç—É', '—Ç—Ä–µ–±—É–µ—Ç—Å—è'],
  
  // –¢—É—Ä–∏–∑–º
  'puteshestviya': ['—Ç—É—Ä–∏–∑–º', '–æ—Ç–¥—ã—Ö', '–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è', '—Ç—É—Ä', '–ø–æ–µ–∑–¥–∫–∞'],
  'tury': ['—Ç—É—Ä', '—Ç—É—Ä—ã', '–ø—É—Ç–µ–≤–∫–∞', '—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Ç—É—Ä'],
  'aviabilety': ['–∞–≤–∏–∞–±–∏–ª–µ—Ç—ã', '–±–∏–ª–µ—Ç—ã –Ω–∞ —Å–∞–º–æ–ª–µ—Ç', '–∞–≤–∏–∞', '—Å–∞–º–æ–ª–µ—Ç'],
  'zhd-bilety': ['–∂–¥ –±–∏–ª–µ—Ç—ã', '–∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–µ –±–∏–ª–µ—Ç—ã', '–ø–æ–µ–∑–¥', '—Ä–∂–¥'],
};

async function populateCategoryKeywords() {
  try {
    console.log('üöÄ Starting category keyword population...');
    
    await mongoose.connect(config.mongoUrl);
    console.log('‚úÖ Connected to MongoDB');

    const categories = await Category.find();
    console.log(`üìä Found ${categories.length} categories`);

    let updatedCount = 0;

    for (const category of categories) {
      const keywords = KEYWORD_MAPPINGS[category.slug] || [];
      
      // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
      const allKeywords = [
        category.name.toLowerCase(),
        ...keywords,
        // –î–æ–±–∞–≤–ª—è–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ/–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞
        category.name.toLowerCase().replace(/—ã$/, ''),
        category.name.toLowerCase().replace(/–∏$/, ''),
      ];

      // –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
      const uniqueKeywords = [...new Set(allKeywords.filter(k => k))];

      // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–µ—Å boost –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
      let boostWeight = 1.0;
      if (['phones-tablets', 'cars', 'apartments-for-sale', 'furniture'].includes(category.slug)) {
        boostWeight = 1.5; // –ü–æ–≤—ã—à–µ–Ω–Ω—ã–π –≤–µ—Å –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
      }

      await Category.updateOne(
        { _id: category._id },
        { 
          $set: { 
            keywordTokens: uniqueKeywords,
            boostWeight 
          } 
        }
      );

      updatedCount++;
      console.log(`‚úÖ Updated ${category.slug}: ${uniqueKeywords.length} keywords (boost: ${boostWeight})`);
    }

    console.log(`\n‚ú® Successfully updated ${updatedCount} categories with keywords`);
    
  } catch (error) {
    console.error('‚ùå Error populating category keywords:', error);
    process.exit(1);
  } finally {
    await mongoose.connection.close();
    console.log('‚úÖ MongoDB connection closed');
  }
}

populateCategoryKeywords();
