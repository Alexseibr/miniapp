import{r as c}from"./vendor-react-C4_xJuq0.js";import{c as d}from"./vendor-ui-DiZGdpRh.js";import{h as l}from"./index-C0UB_dVU.js";const s=d(o=>({coords:null,status:"idle",error:void 0,radiusKm:5,async requestLocation(){if(o({status:"loading",error:void 0}),"geolocation"in navigator){await new Promise(r=>{navigator.geolocation.getCurrentPosition(e=>{const{latitude:a,longitude:n}=e.coords;o({coords:{lat:a,lng:n},status:"ready"}),r()},e=>{o({status:"error",error:e.message||"Геолокация недоступна"}),r()},{enableHighAccuracy:!0,timeout:8e3})});return}o({status:"error",error:"Геолокация не поддерживается"})},setRadius(r){o({radiusKm:r})}}));async function f(o){try{await l.post("/api/users/set-location",o)}catch(r){console.warn("set-location endpoint unavailable:",r)}}function h(o=!0){const r=s(t=>t.coords),e=s(t=>t.status),a=s(t=>t.error),n=s(t=>t.requestLocation),i=s(t=>t.setRadius),u=s(t=>t.radiusKm);return c.useEffect(()=>{o&&r&&f(r)},[r,o]),{coords:r,status:e,error:a,radiusKm:u,requestLocation:n,setRadius:i}}function v(o){return o==null?"":o<1?`${Math.round(o*1e3)} м`:`${o.toFixed(1)} км`}export{v as f,h as u};
